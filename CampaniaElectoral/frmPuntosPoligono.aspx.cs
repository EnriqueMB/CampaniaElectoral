using CampaniaElectoral.ClasesAux;
using DllCampElectoral.Global;
using DllCampElectoral.Negocio;
using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace CampaniaElectoral
{
    public partial class frmPuntosPoligono : System.Web.UI.Page
    {
        public List<CH_Poligono> Lista = new List<CH_Poligono>();
        public string IDPoligono = string.Empty;
        protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                
                if (Request.QueryString["id"] != null)
                {
                    if (Request.QueryString["op"] != null)
                    {
                        if(Request.QueryString["op"] == "3")
                        {
                            string ID = Request.QueryString["id"].ToString();
                            CH_Poligono Punto = new CH_Poligono { IDPunto = ID, Conexion = Comun.Conexion, IDUsuario = Comun.IDUsuario };
                            CH_PoligonoNegocio PolNeg = new CH_PoligonoNegocio();
                            PolNeg.EliminarPuntoPoligonoXID(Punto);
                            IDPoligono = Request.QueryString["idP"].ToString();
                            if (Punto.Completado)
                            {
                                string ScriptError = DialogMessage.Show(TipoMensaje.Success, "Eliminación completa.", "Informacion", ShowMethod.FadeIn, HideMethod.FadeOut, ToastPosition.TopFullWidth, true);
                                ScriptManager.RegisterStartupScript(this, typeof(Page), "popup", ScriptError, true);
                                Response.Redirect("frmPuntosPoligono.aspx?id=" + this.IDPoligono, true);
                            }
                            else
                            {
                                string ScriptError = DialogMessage.Show(TipoMensaje.Error, "Error al eliminar el registro.", "Error", ShowMethod.FadeIn, HideMethod.FadeOut, ToastPosition.TopFullWidth, true);
                                ScriptManager.RegisterStartupScript(this, typeof(Page), "popup", ScriptError, true);
                            }
                        }
                        else
                        {
                            Response.Redirect("frmPoligonosGrid.aspx?error=" + "Parametros incorrectos");
                        }
                    }
                    else
                    {
                        string ID = Request.QueryString["id"].ToString();
                        CH_Poligono DatosAux = new CH_Poligono { Conexion = Comun.Conexion, IDPoligono = ID };
                        CH_PoligonoNegocio CN = new CH_PoligonoNegocio();
                        IDPoligono = ID;
                        CN.ObtenerDetallePoligonoXIDResumen(DatosAux);
                        if (DatosAux.Completado)
                        {
                            this.CargarDatos(DatosAux);
                        }
                        else
                        {
                            //Ocurrió un error
                            Response.Redirect("frmPoligonosGrid.aspx?error=" + "Error al cargar los datos&nError=1");
                        }
                    }
                }
                else
                    Response.Redirect("frmPoligonosGrid.aspx");
            }
            else
            {
                if(Request.Form.Count > 0)
                {
                    string IDPoligono = Request.Form["ctl00$cph_MasterBody$hf"].ToString();
                    double Latitud = 0, Longitud = 0, LatitudIni = 0, LongitudIni = 0;
                    CultureInfo esMX = new CultureInfo("es-MX");
                    double.TryParse(Request.Form["hfLatitud"].ToString(), NumberStyles.Currency, esMX, out Latitud);
                    double.TryParse(Request.Form["hfLongitud"].ToString(), NumberStyles.Currency, esMX, out Longitud);
                    this.Guardar(IDPoligono, Latitud, Longitud, Latitud, Longitud);

                    string Script = DialogMessage.Show(TipoMensaje.Success, "Datos guardados correctamente.", "Success", ShowMethod.FadeIn, HideMethod.FadeOut, ToastPosition.TopFullWidth, true);
                    ScriptManager.RegisterStartupScript(this, typeof(Page), "popup", Script, true);
                    Response.Redirect(Request.Url.AbsoluteUri);
                }
            }
        }

        private void CargarDatos(CH_Poligono DatosAux)
        {
            try
            {
                //Iniciar el mapa
                string Aux01 = DatosAux.Latidud.ToString().Replace(",", ".");
                string Aux02 = DatosAux.Longitud.ToString().Replace(",", ".");

                //
                string ScriptError =

                //
                @"   jQuery(document).ready(function() {
                        Maps.init(" + Aux01 + ", " + Aux02 + @");
                            console.log(" + Aux01 + ", " + Aux02 + @")
                        });";
                ScriptManager.RegisterStartupScript(this, typeof(Page), "popup", ScriptError, true);

                hf.Value = DatosAux.IDPoligono;
                hf2.Value = "[[[17.3259319181697,-92.59707715442356],[17.32438932881897,-92.59761623768026],[17.3227809393251,-92.59741884610227],[17.32078636348101,-92.59708837173211],[17.31808386841428,-92.59655855992163],[17.3144568964424,-92.59918540814243],[17.31387447596991,-92.5990848349832],[17.31345397737776,-92.59880849615014],[17.31316025593044,-92.59864368983095],[17.31228662474944,-92.59849283380304],[17.31174813723094,-92.59850578705085],[17.31125358296377,-92.59863226311016],[17.31078610472553,-92.59864350776998],[17.31071509537089,-92.5986452158123],[17.30980255305022,-92.59860987630853],[17.30930172076977,-92.59845005537184],[17.30867662196881,-92.59829322452086],[17.30825988935735,-92.59818867118419],[17.3066306130042,-92.59759769119145],[17.30600802518806,-92.59755538133595],[17.30550719200522,-92.59739556631973],[17.30405113769337,-92.59714415925217],[17.30363566036207,-92.59709686817655],[17.30322018300687,-92.59704957729248],[17.30280470562773,-92.59700228659997],[17.30114028379909,-92.59669861273513],[17.30076622842546,-92.59665032655869],[17.30035200694934,-92.5966602935264],[17.3000193736926,-92.59661101089658],[17.29964783039763,-92.59667723722106],[17.29931770921524,-92.5967424665993],[17.29902901015158,-92.59680669908543],[17.29869888889745,-92.59687192799071],[17.29832734544676,-92.59693815326104],[17.2968738018247,-92.59680126865287],[17.29649723428711,-92.59663847304893],[17.2959537218664,-92.59642240995274],[17.29554126365125,-92.59631562555032],[17.29453657519219,-92.59605551619434],[17.29412109731245,-92.59600822951617],[17.29374452911246,-92.59584543783359],[17.29344954881427,-92.59562339900647],[17.29315833732016,-92.59557312294112],[17.29195332535954,-92.59543027070072],[17.29141609344599,-92.59550048357725],[17.2910006153491,-92.59545319878559],[17.29067049426255,-92.5955184269417],[17.29038179531956,-92.59558265802242],[17.29013451852568,-92.59564589207987],[17.28984581951846,-92.59571012275799],[17.28931109980771,-92.59589483955882],[17.28812134129636,-92.59584132742668],[17.28765169973995,-92.59582020435829],[17.28736174437596,-92.59582718158285],[17.28707555756039,-92.5960059152133],[17.28670903834521,-92.5963011456747],[17.28578673841282,-92.59740231750487],[17.28117601869137,-92.60290696779889],[17.28067393446992,-92.60268990787952],[17.28033879343884,-92.60252611852181],[17.27983545447805,-92.60225181057913],[17.2795003130932,-92.60208802272892],[17.27865681367469,-92.60142093235145],[17.2784421745758,-92.60108241204996],[17.27830912471615,-92.60068465193521],[17.27825640882789,-92.60017040214177],[17.27824511389938,-92.59965515687671],[17.2783492975508,-92.59873617752554],[17.27833925440513,-92.59827818165167],[17.27837314361481,-92.59793368861506],[17.27836560998033,-92.59759019172216],[17.27819364251027,-92.59730792961815],[17.27785724146661,-92.5970869028676],[17.2773601744788,-92.59709885918085],[17.27694971924392,-92.59728056981054],[17.27670746416876,-92.59757279248107],[17.27655056426697,-92.59797751988347],[17.27651793033153,-92.59837925843677],[17.27644387331925,-92.59878199283698],[17.27641374811016,-92.5992982288483],[17.27634094427404,-92.59975821157717],[17.27630956166081,-92.60021719831998],[17.27627566843822,-92.60056168718317],[17.2761589300388,-92.60090816691906],[17.27587399262749,-92.60114413036422],[17.27558529117079,-92.60120834707097],[17.27525516738221,-92.60127355896961],[17.27476813589031,-92.60174349108267],[17.27461122739176,-92.60214821087223],[17.27445682646039,-92.60266742666734],[17.2744718754871,-92.60335440681594],[17.27456851302192,-92.60398214918587],[17.27461996530815,-92.60443914165982],[17.27484964060593,-92.60546464097197],[17.2748571606454,-92.60580813197306],[17.27495128430143,-92.60632138001149],[17.27495754982429,-92.60660762272241],[17.27497258541622,-92.60729460534429],[17.27473657910097,-92.60787305452968],[17.27449556081124,-92.60822250856931],[17.27429471175342,-92.60851371957982],[17.27396959512852,-92.60880791108214],[17.27351895854763,-92.60904783432153],[17.27319133649094,-92.60922752757313],[17.27277961721603,-92.60935195938998],[17.27228630527813,-92.60953562547144],[17.27187458574914,-92.60966005595675],[17.27162980782929,-92.60983775958006],[17.27146912659745,-92.61007072342413],[17.27131220097663,-92.61047542927298],[17.2711540226926,-92.61082288702519],[17.27078372465676,-92.61094632065999],[17.27045234537107,-92.61095426619886],[17.26999169153587,-92.6107362029738],[17.26965280082878,-92.61040066705961],[17.26944193286125,-92.61023389290251],[17.26918713823253,-92.60995361887993],[17.26893234322192,-92.60967334562838],[17.26825706244295,-92.60911677575389],[17.26775247948797,-92.60878522051834],[17.26741609055362,-92.60856418468691],[17.26707594374506,-92.60817141124478],[17.26677346046959,-92.60760590728314],[17.26676469096727,-92.60720518508381],[17.26677478717562,-92.60577304051682],[17.26680618301947,-92.60531407807045],[17.26679364838537,-92.604741618001],[17.26673843604364,-92.60411290673511],[17.2667660664542,-92.60348220624812],[17.26671335831234,-92.60296798744243],[17.26674098512706,-92.60233728695029],[17.26672718761865,-92.60170758153055],[17.26658284800303,-92.60079463287792],[17.26661674203153,-92.60045016209665],[17.26664812570539,-92.59999119941227],[17.26663934102788,-92.59959047818207],[17.26670210338759,-92.59867255236679],[17.26659163884588,-92.59741513533736],[17.26636317932854,-92.59644693811819],[17.26622635261338,-92.59587747012118],[17.26613848365303,-92.59565048041695],[17.26596902606071,-92.59548272977887],[17.26559622550888,-92.59549169912975],[17.26501505733742,-92.59544840601707],[17.2648066897173,-92.59539614371896],[17.26451798988709,-92.59546036511216],[17.26431339075106,-92.59557983826942],[17.26407490556358,-92.59604377795708],[17.26399959669992,-92.59638924101692],[17.26384897717143,-92.5970801663334],[17.26356529933597,-92.59737336437732],[17.26328162104599,-92.59766656152441],[17.26295903085351,-92.59807524324718],[17.26259250683074,-92.59837043020173],[17.26222598233674,-92.59866561598328],[17.26158079678008,-92.59948296989685],[17.26129962504015,-92.59989064916616],[17.2611853966062,-92.60035158953214],[17.2610309993666,-92.60087076888169],[17.26091676865508,-92.60133170802352],[17.26075986015324,-92.60173639765367],[17.26068579555819,-92.60213909650197],[17.26057030777581,-92.60254279001215],[17.2603682122951,-92.60277674079774],[17.26021004686858,-92.60312418411398],[17.25935773058835,-92.60394648709843],[17.2589083526596,-92.60424364589727],[17.25858073430835,-92.60442333281513],[17.25821043983091,-92.60454677021886],[17.25767320211624,-92.6046169417738],[17.25666270887491,-92.60578666097634],[17.25637901762598,-92.60607983439117],[17.25621959320836,-92.60637002471196],[17.25598233509,-92.60689117331143],[17.25578148703038,-92.60718235621478],[17.25538354736288,-92.60793644771162],[17.25522537265819,-92.60828387740068],[17.25490275987398,-92.60869252308993],[17.25457638946148,-92.60892944049475],[17.25388347737929,-92.60946150823257],[17.25364120296021,-92.60975367837948],[17.25336000949138,-92.61016132483992],[17.25320057896708,-92.61045150700721],[17.25308632567884,-92.61091242118184],[17.25300973901979,-92.61120061638333],[17.25289548399319,-92.61166152965795],[17.25241468197595,-92.61241758541802],[17.25196529057278,-92.61271471249464],[17.25159999479256,-92.61306709446691],[17.25087690622278,-92.6141153015152],[17.25071746980611,-92.61440547648293],[17.25060070609305,-92.61475189994388],[17.250610710341,-92.6152098290859],[17.25070105791989,-92.61555129206595],[17.25078890434691,-92.6157782729687],[17.25100226838011,-92.61605951977722],[17.25129597678439,-92.61622430090564],[17.25171520281124,-92.61644334869443],[17.252175851144,-92.6166614057278],[17.25246955906055,-92.61682618882082],[17.25264024917639,-92.61705118920823],[17.25285111169132,-92.61721795654776],[17.25306697338759,-92.61761369199596],[17.25311714411593,-92.6180133941325],[17.25283234758593,-92.61923293105534],[17.25216619213732,-92.61871653150423],[17.25108581697059,-92.61856169017786],[17.24980126743893,-92.61858244913175],[17.24885825077633,-92.61917201518715],[17.24761814844647,-92.61936434809395],[17.24653777329101,-92.61920950621335],[17.24492473659292,-92.61940786085394],[17.24314996432941,-92.61983854797131],[17.24153993599536,-92.62020913554326],[17.24033424618013,-92.61999888689527],[17.2397056659344,-92.61960702996407],[17.23815543242415,-92.61865577091898],[17.23744196782599,-92.61815043638804],[17.23722273572528,-92.61746483030601],[17.23636989339276,-92.61610032392105],[17.23593744126582,-92.61507360092486],[17.23571719398732,-92.61433059186761],[17.23545651194481,-92.61364566751027],[17.23540200785908,-92.61289997904713],[17.23573028853629,-92.61132844054136],[17.23458935029816,-92.61032499372109],[17.23403833871952,-92.60976554240762],[17.23381745394336,-92.60914091288335],[17.23371582568436,-92.6082843613858],[17.23361544636502,-92.60748504671615],[17.2336795011979,-92.60662452210052],[17.23398958130141,-92.60564356132782],[17.23451303570607,-92.60494380652389],[17.23555868319131,-92.60348704879436],[17.23587376345579,-92.60273501891089],[17.23594030601817,-92.60198895554564],[17.23580224213696,-92.60136233951461],[17.2356202448476,-92.60062224688447],[17.23556251222416,-92.59987916986269],[17.23559264141107,-92.59936304768212],[17.23572067740179,-92.59764197555279],[17.23582736788864,-92.5968376790828],[17.23587128128508,-92.59506135991107],[17.2358963729404,-92.59431629099483],[17.23588129596181,-92.59362945497701],[17.23598922707913,-92.59288239222197],[17.23597288827266,-92.59213831975252],[17.2346271858885,-92.58936466759931],[17.24262428865606,-92.59117645218328],[17.24675587498716,-92.58116927802264],[17.2467483614325,-92.58113659954887],[17.24666420926146,-92.5807706008315],[17.24649095866044,-92.58043116299631],[17.24635534834798,-92.57991900786453],[17.24613689232619,-92.57940885345857],[17.24591591346574,-92.57878422183626],[17.24581793830527,-92.57809935181334],[17.24584927203013,-92.57764043804602],[17.24608645438169,-92.5771192825512],[17.24645042471008,-92.57670960264881],[17.24681060954616,-92.5761282027609],[17.2469285680536,-92.57583900314816],[17.24704021729757,-92.57526360557125],[17.24703138424053,-92.57486292897347],[17.2471041326551,-92.57440301073234],[17.2471316712314,-92.57377237477559],[17.24703620379684,-92.57320198231079],[17.24698594449372,-92.57280230737445],[17.24714279508511,-92.57239762494206],[17.24807529989373,-92.57145875245156],[17.24848068039378,-92.57104805538577],[17.2490103263324,-92.57063435064502],[17.25047372877323,-92.56933898843113],[17.25058788637796,-92.56887805740087],[17.25074093739833,-92.56830164222447],[17.25175879416157,-92.56747520727984],[17.2521265363898,-92.56723721908229],[17.25261601605196,-92.56688173925383],[17.25323102550533,-92.56658049007328],[17.25384856321341,-92.56639372184515],[17.25438199215212,-92.5661517166856],[17.25544884897676,-92.56566770210246],[17.25573374468286,-92.56543171185621],[17.25593200176222,-92.56502600101999],[17.25613025799929,-92.56462028933179],[17.25641009240086,-92.56415532759162],[17.25677276970508,-92.56368835727774],[17.25729733788834,-92.56304564279145],[17.25770269995881,-92.56263490687556],[17.25818963950593,-92.56216491851606],[17.25924762488999,-92.56128016913061],[17.25965424907024,-92.56092666823345],[17.25997676256571,-92.56051793112583],[17.26025911943164,-92.56016744041969],[17.26135851726525,-92.55928166507452],[17.26193082540976,-92.5589241368986],[17.26246171090241,-92.55856761128818],[17.26299132890958,-92.55815383941476],[17.26393263131448,-92.55761552620695],[17.26425640464731,-92.55726401847639],[17.26437180063231,-92.55686029086162],[17.26423739708738,-92.55640534994481],[17.26406157062611,-92.55595141511132],[17.26388701069692,-92.55555472559917],[17.26379149077474,-92.55498429248736],[17.26373865897985,-92.55447009864078],[17.26368328987015,-92.55384141641089],[17.26375598894667,-92.55338144968354],[17.2638274186714,-92.55286423823675],[17.26398803281423,-92.55263123615312],[17.26439717785068,-92.5523921964903],[17.26472728429154,-92.55232690222552],[17.26514277133727,-92.55237408480602],[17.26539510776434,-92.55253978211242],[17.26569140259997,-92.5528189636359],[17.26573662936199,-92.55298969243651],[17.26586977249319,-92.55338738931317],[17.26607941812096,-92.55349684951383],[17.26641586546823,-92.55371778249545],[17.26674977652147,-92.55382422566946],[17.26749283394674,-92.55369162821684],[17.26777644631138,-92.5533983585387],[17.26797594624479,-92.55304985445483],[17.26813656041971,-92.55281684722455],[17.26837874958815,-92.55252458141121],[17.26874647234008,-92.55228654188427],[17.26940668475074,-92.55215594928185],[17.26986359349917,-92.55220212610435],[17.27023892706037,-92.55230756207062],[17.27052887991058,-92.55230051808039],[17.27086406004382,-92.55246420740717],[17.27136365895922,-92.55256662571898],[17.2717778772927,-92.55255656331983],[17.27215067377686,-92.55254750710229],[17.27334048995628,-92.55200309976999],[17.27370821173711,-92.5517650526068],[17.27399435831757,-92.55158626498616],[17.27432065773238,-92.55134922267762],[17.27460553503181,-92.55111318612444],[17.27481961757479,-92.55093580628626],[17.27489041202897,-92.55087714884172],[17.2751325979062,-92.55058486969693],[17.27529067062671,-92.55023735548241],[17.27532320812613,-92.54983561343305],[17.27527417059461,-92.54949313308985],[17.27505436748274,-92.54892568992446],[17.27500532841529,-92.54858321035616],[17.27482694454406,-92.54801476185877],[17.274765204578,-92.54709980615168],[17.27471616241918,-92.54675732767778],[17.27466330897128,-92.54624310649147],[17.27448745935785,-92.5457891565996],[17.27439318170437,-92.5452759442837],[17.27429763206265,-92.54470548502182],[17.2745761472839,-92.54418320058099],[17.27457948526471,-92.54376291018492],[17.27458706398021,-92.54280825059851],[17.27466100834124,-92.54240550061012],[17.27465465136673,-92.5421192627289],[17.27448006407998,-92.54172256452183],[17.27434816938242,-92.54138210576585],[17.27425642407287,-92.54098339122994],[17.27403659720528,-92.54041596185415],[17.27373265329145,-92.53979330480851],[17.27351918417662,-92.53951211443155],[17.27322287130058,-92.5392329431764],[17.27275959896581,-92.53890056303676],[17.27263278919437,-92.53878909713804],[17.27241931871771,-92.53850790958919],[17.27220457532333,-92.5381694759302],[17.27207140208529,-92.53777177728004],[17.27206503860415,-92.53748554372439],[17.27238113793394,-92.53679050517283],[17.27258188136494,-92.53649922202926],[17.27278644359945,-92.53637967899961],[17.27311399762723,-92.53619985899773],[17.27343900510656,-92.53590554412804],[17.27380288716836,-92.53549572373863],[17.27424961162619,-92.53508388139977],[17.27440256298293,-92.53450736677381],[17.27426683501006,-92.53399517159122],[17.27438473095123,-92.53370590347542],[17.27458546971217,-92.5334146139037],[17.27495189450664,-92.53311928123502],[17.2757637632822,-92.5323548475176],[17.27609003908038,-92.53211776959827],[17.2762468050061,-92.53171299072693],[17.27615758955056,-92.53142877318388],[17.27617479283568,-92.53034005234477],[17.27625126178005,-92.53005179035259],[17.27632645532796,-92.52970628022023],[17.27652591299218,-92.52935773539402],[17.27672792036861,-92.52912368588024],[17.27692865222607,-92.52883238777197],[17.27717080520258,-92.52854007737136],[17.27753722239944,-92.52824473100117],[17.2778634930561,-92.52800764362375],[17.27814834185296,-92.52777156725402],[17.27847588750273,-92.52759172679237],[17.27880343296516,-92.52741188568396],[17.27913225394245,-92.52728929267131],[17.27937440448526,-92.52699697676211],[17.27957385717459,-92.52664842332565],[17.28021363299515,-92.52560174621897],[17.28045450468271,-92.52525217730405],[17.28060997991543,-92.52479013419757],[17.28080815210729,-92.52438432690923],[17.28109171971968,-92.52409099190932],[17.28141670836651,-92.52379664323664],[17.2818232627207,-92.52344301831813],[17.28293525848405,-92.52312942157404],[17.28334181149382,-92.52277579223551],[17.2837056652338,-92.52236592436182],[17.28394142187501,-92.52178734407796],[17.28401787809681,-92.52149906671625],[17.28413447788003,-92.52115252554353],[17.28438045159775,-92.52103194460014],[17.28479466610153,-92.52102181029676],[17.28508461624302,-92.52101471624268],[17.28670102816437,-92.52057270206238],[17.28686493093165,-92.5214379467111],[17.28748563520311,-92.52241910204673],[17.28839784796072,-92.52316994952851],[17.28918570123514,-92.52380530781511],[17.29031139904891,-92.52352530515641],[17.29064015933254,-92.52380713316413],[17.29138318166181,-92.52565353391275],[17.2910871317832,-92.52755629616904],[17.29199822801901,-92.52871087994744],[17.29315991091453,-92.52940442590291],[17.29427956358571,-92.53027094177948],[17.29519096001592,-92.53131021497838],[17.29576879761832,-92.53275277090737],[17.29534912315902,-92.53425170123335],[17.29551360284249,-92.53488631157185],[17.2957605570242,-92.53575172109308],[17.29472165738172,-92.53575035100194],[17.29442933456905,-92.53626901278555],[17.29488390339211,-92.53719236672319],[17.29471496847405,-92.538172567061],[17.2952130019143,-92.53840391914217],[17.29691424108232,-92.53932895045924],[17.29903103604016,-92.54025455643352],[17.30085516915747,-92.54181420241457],[17.30218126266639,-92.54314250457375],[17.30313285953914,-92.54464333874611],[17.30296049008435,-92.54683474034107],[17.30428833677131,-92.54752867055191],[17.30486671050638,-92.54874065009196],[17.30353350018903,-92.54994997203087],[17.30203405785793,-92.55115904358299],[17.30119819462155,-92.55283042293183],[17.29982126673096,-92.55478938818317],[17.29832096946394,-92.55628676153691],[17.29706999676807,-92.55778446903614],[17.2954052726454,-92.5586471617023],[17.29436338850264,-92.55968375625736],[17.29464846835448,-92.56170269547688],[17.29447724520003,-92.56343260994288],[17.29376678123381,-92.56481569306347],[17.29390996800609,-92.56559447621073],[17.29405315178036,-92.56637326063351],[17.29546102170513,-92.56810552480235],[17.29724836104889,-92.56841029508834],[17.29764226811566,-92.56840937672456],[17.29813457840315,-92.56837405806483],[17.298495365687,-92.56823653316683],[17.29895455601952,-92.56806460712001],[17.29961047877239,-92.56778970758248],[17.30046423829224,-92.56792439900785],[17.30191040224511,-92.56877531129132],[17.30283098672867,-92.56945660042759],[17.30372057280395,-92.57099226533997],[17.30369117666703,-92.57259841190094],[17.30316967390909,-92.57434237772337],[17.3024833774029,-92.57577916643692],[17.30225547553932,-92.57666815129493],[17.30215844015512,-92.57735180560455],[17.30219191365752,-92.5776592737847],[17.30227789864502,-92.58158958445797],[17.30240178682065,-92.58190014242327],[17.30338038324503,-92.58206376877847],[17.30381418036957,-92.58207538142344],[17.30564420058382,-92.581559168832],[17.3059721721474,-92.58305925470472],[17.30599866356634,-92.58807709976774],[17.30716119333039,-92.58842501764497],[17.30882639568252,-92.58744717943256],[17.31061417927725,-92.58716164659656],[17.31079778408992,-92.58773572962679],[17.31266456123734,-92.58846813618946],[17.3151817581395,-92.588129332778],[17.3165222125417,-92.58772296827982],[17.32108930234269,-92.58791367467636],[17.32261593130353,-92.58823616021431],[17.32359885889325,-92.58844379686239],[17.32527390934248,-92.58977937198765],[17.3263068503144,-92.59165211721621],[17.3259319181697,-92.59707715442356]], [[17.28842303820298,-92.55282632097669],[17.2884123168845,-92.55273315170111],[17.28839819776052,-92.5523247844301],[17.28839561125882,-92.55224132902553],[17.28839255527687,-92.55214272694016],[17.28839099169964,-92.55209227830117],[17.28837341898928,-92.55164978155173],[17.28836953822161,-92.55156387521734],[17.28833612044123,-92.55082415872526],[17.28828567902175,-92.5507919327226],[17.28823148742725,-92.55075731083188],[17.2871671677364,-92.55020834581045],[17.28693477456193,-92.5500884807536],[17.28471208481615,-92.548942066089],[17.28330367854563,-92.54825025399821],[17.28285234267251,-92.54844448206826],[17.28168445317488,-92.54895178876463],[17.28160116751671,-92.54898796603114],[17.28065343873262,-92.54913899308316],[17.27926759443079,-92.54977179227699],[17.27915909687157,-92.54963526487646],[17.27912259526591,-92.5496669300788],[17.27899288574538,-92.54977945315957],[17.27894016498023,-92.54982518839029],[17.27886256977477,-92.54988297278416],[17.27882285491017,-92.55028668659737],[17.27881074605985,-92.5505626392976],[17.27777416967165,-92.55175271161646],[17.27770228842781,-92.55183523620369],[17.27818164279513,-92.55209244335698],[17.27870913604768,-92.5523754821005],[17.27883132052254,-92.55243230445936],[17.27905596031523,-92.55252985562399],[17.27907986039107,-92.55257422043853],[17.27910281973773,-92.55261683904018],[17.27924930161148,-92.5530167888829],[17.27962313986272,-92.55335301573766],[17.27966527714582,-92.553400245653],[17.27969673016997,-92.55343550005205],[17.28028329198525,-92.55404714753334],[17.2803252606621,-92.55408578365704],[17.28036722933164,-92.55412441979817],[17.28091296718411,-92.554655012613],[17.28096125999322,-92.55470241880663],[17.28100955279142,-92.55474982502491],[17.2816032978465,-92.55537878296303],[17.2816564765292,-92.55542073919038],[17.28170965520338,-92.55546269544163],[17.28224374974258,-92.55601260996419],[17.28228106158599,-92.55605465517998],[17.28231432070889,-92.55609213357049],[17.28293421775483,-92.55671091291882],[17.28296828158886,-92.55675203757988],[17.28300234541474,-92.55679316225613],[17.28351415814302,-92.55731096736596],[17.2835637667217,-92.55735693392764],[17.28360714905623,-92.55739713137307],[17.28393772271571,-92.55776263836704],[17.28402726221889,-92.55781467384804],[17.28427188263769,-92.55808466088119],[17.28576681435446,-92.55649435201252],[17.28580572925576,-92.55645295379415],[17.28607033160483,-92.55617146538285],[17.28589287348779,-92.55598112040777],[17.28592015809893,-92.55594781407781],[17.28604781848363,-92.55579626222834],[17.28634098425205,-92.55547181466045],[17.28636087279658,-92.55544987728565],[17.28638040214408,-92.55542833610338],[17.28639993148922,-92.55540679491658],[17.28653612901248,-92.55525656552078],[17.28659993630365,-92.55518702002166],[17.28664771436288,-92.55513494521838],[17.28669549240772,-92.55508287038826],[17.28673947049393,-92.55503493721783],[17.28678344856807,-92.5549870040247],[17.28697685283132,-92.5547860371134],[17.28703191832597,-92.55472881828621],[17.2876261431653,-92.5540722673482],[17.28792457121565,-92.55378037644181],[17.2881592507194,-92.55355083667912],[17.28822482669865,-92.55348669673309],[17.28845460912821,-92.55320504081603],[17.28842770969649,-92.55291221348421],[17.28842303820298,-92.55282632097669]]]";
                txtNombrePoligono.Value = DatosAux.Nombre;
                txtEstado.Value = DatosAux.EstadoDesc;
                txtMunicipio.Value = DatosAux.MunicipioDesc;
                txtClave.Value = DatosAux.Clave;
                txtColonia.Value = DatosAux.Colonia;
                Lista = DatosAux.ListaPuntos;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }


        private void Guardar(string _ID, double _Latitud, double _Longitud, double _LatitudIni, double _LongitudIni)
        {
            try
            {
                CH_Poligono Datos = new CH_Poligono
                {
                    IDPoligono = _ID,
                    Latidud = _Latitud,
                    Longitud = _Longitud,
                    Conexion = Comun.Conexion,
                    IDUsuario = User.Identity.Name
                };
                CH_PoligonoNegocio PolN = new CH_PoligonoNegocio();
                PolN.APuntosPoligono(Datos);
                if (Datos.Completado)
                {
                    Datos.EsPrincipal = false;
                    Lista = PolN.ObtenerPuntosPoligonos(Datos);
                    //string ScriptError = DialogMessage.Show(TipoMensaje.Success, "Datos guardados correctamente.", "Success", ShowMethod.FadeIn, HideMethod.FadeOut, ToastPosition.TopFullWidth, true);
                    //ScriptManager.RegisterStartupScript(this, typeof(Page), "popup", ScriptError, true);
                    string Aux01 = _LatitudIni.ToString().Replace(",", ".");
                    string Aux02 = _LongitudIni.ToString().Replace(",", ".");
                    string ScriptError =
                    @"   jQuery(document).ready(function() {
                        Maps.init(" + Aux01 + ", " + Aux02 + @");
                            console.log(" + Aux01 + ", " + Aux02 + @")
                        });";
                    ScriptError += DialogMessage.Show(TipoMensaje.Success, "Datos guardados correctamente.", "Success", ShowMethod.FadeIn, HideMethod.FadeOut, ToastPosition.TopFullWidth, true); 
                    ScriptManager.RegisterStartupScript(this, typeof(Page), "popup", ScriptError, true);
                }
                else
                {
                    string ScriptError = DialogMessage.Show(TipoMensaje.Error, "Error al guardar los datos.", "Error", ShowMethod.FadeIn, HideMethod.FadeOut, ToastPosition.TopFullWidth, true);
                    ScriptManager.RegisterStartupScript(this, typeof(Page), "popup", ScriptError, true);
                }
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }


    }
}